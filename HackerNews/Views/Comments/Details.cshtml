@model HackerNews.ViewModels.Comments.CommentDetailsViewModel

@{
    ViewData["Title"] = "Details";
}

<div class="container">
    <div class="row">
        <div class="vote-panel d-none d-md-block col-md-1 text-center">
            <a asp-controller="Comments" asp-action="vote" asp-route-id="@Model.GetModel.Id" asp-route-upvote="@true">
                <i class="fas fa-caret-up"></i>
            </a>
            <div class="">@Model.GetModel.Karma</div>
            <a asp-controller="Comments" asp-action="vote" asp-route-id="@Model.GetModel.Id" asp-route-upvote="@false">
                <i class="fas fa-caret-down"></i>
            </a>
        </div>
        <div class="col-sm-12 col-md-11">
            <div>
                <a asp-controller="Users" asp-action="Details" asp-route-id="@Model.User.Id">@Model.User.Username</a> at
                @Model.GetModel.PostDate

                @*|  <a asp-controller="Boards" asp-action="Details" asp-route-id="@Model.Board.Id">@Model.Board.Title</a>*@

                |
                @if (Model.ParentArticle != null)
                {
                    <a asp-controller="Articles" asp-action="Details" asp-route-id="@Model.ParentArticle.Id">Parent</a>
                }
                @if (Model.ParentComment != null)
                {
                    <a asp-controller="Comments" asp-action="Details" asp-route-id="@Model.ParentComment.Id">Parent</a>
                }

                @if (Model.LoggedIn)
                {
                    <text>
                        | <a asp-controller="Comments" asp-action="SaveComment" asp-route-id="@Model.GetModel.Id">
                            @if (Model.UserSavedComment)
                            {
                                <text>Unsave</text>
                    }
                    else
                    {
                        <text>Save</text>
                    }
                    </a>
                     </text>
                }
            </div>
            <p>
                @Model.GetModel.Text
            </p>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col">
            @* Add Comment*@
            <form asp-controller="Comments" asp-action="AddComment" method="post">
                <div class="form-group">
                    <textarea class="form-control" asp-for="PostCommentModel.Text"></textarea>
                </div>
                <input hidden asp-for="GetModel.Id" />
                <input hidden asp-for="GetModel.BoardId" />
                <input hidden asp-for="GetModel.UserId" />

                <div class="form-group">
                    <input type="submit" class="btn btn-outline-secondary" value="Add comment" />
                </div>
            </form>
            <div class="container-fluid">
                @foreach (var childComment in Model.ChildComments)
                {
                    @await Component.InvokeAsync("CommentCard", new { commentModel = childComment });
                }
            </div>
        </div>
    </div>
</div>